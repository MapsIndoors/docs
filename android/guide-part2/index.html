<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>MapsIndoors for Android - Part 2 - MapsIndoors Developers</title>
    <meta name="generator" content="Hugo 0.26" />

    
    <meta name="description" content="Everything you need to get started with MapsIndoors.">
    
    <link rel="canonical" href="https://mapsindoors.github.io/android/guide-part2/">
    
    <meta name="author" content="MapsPeople">
    

    <meta property="og:url" content="https://mapsindoors.github.io/android/guide-part2/">
    <meta property="og:title" content="MapsIndoors Developers">
    <meta property="og:image" content="https://mapsindoors.github.io/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="MapsIndoors Developers">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://mapsindoors.github.io/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://mapsindoors.github.io/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://mapsindoors.github.io/fonts/icon.eot');
        src: url('https://mapsindoors.github.io/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://mapsindoors.github.io/fonts/icon.woff')
               format('woff'),
             url('https://mapsindoors.github.io/fonts/icon.ttf')
               format('truetype'),
             url('https://mapsindoors.github.io/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://mapsindoors.github.io/stylesheets/application.css">
    <link rel="stylesheet" href="https://mapsindoors.github.io/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://mapsindoors.github.io/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://mapsindoors.github.io/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,700|Roboto&#43;Mono">
    <style>
      body, input {
        font-family: 'Roboto', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <link rel="stylesheet" href="https://mapsindoors.github.io/style.css">
    
    <script src="https://mapsindoors.github.io/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-light-blue palette-accent-orange">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
    
  <div class="bar default">
      
      
      <div class="button button-back" role="button" aria-label="Back">
        <a href="../" title="Back" class="toggle-button icon icon-back"></a>
      </div>
      
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        MapsIndoors for Android - Part 2
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/MapsIndoors" title="@MapsIndoors on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">

  
  
    
    
    
    <a href="https://mapsindoors.github.io/android" class="project">
      <div class="banner">
        <div class="logo">
          <img src="https://mapsindoors.github.io//logos/android-logo.svg" style="padding:10px">
        </div>
        <div class="name">
          <strong>Android SDK <span class="version">1.8.5</span></strong>
          
        </div>
      </div>
    </a>
    
  
    
    
    
  
    
    
    
  
    
    
    
  
  <hr />
  <div class="scrollable">
    <div class="wrapper">
      <div class="toc">
          
          
                  
          <ul>
            
            


<li>
    <span class="section">Android SDK</span>
    <ul>
      
        
        



<a  title="Getting Started" href="https://mapsindoors.github.io/android">
	
	Getting Started
</a>



      
        
        



<a class="current" title="Next Steps" href="https://mapsindoors.github.io/android/guide-part2">
	
	Next Steps
</a>


<ul id="scrollspy">
</ul>


      
        
        



<a  title="Reference Docs" href="https://app.mapsindoors.com/mapsindoors/reference/android/index.html">
	
	Reference Docs
</a>



      
    </ul>
</li>
          </ul>
          
          
          
          
          
          
          
          
          
          
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/MapsIndoors" target="_blank" title="@MapsIndoors on GitHub">
              @MapsIndoors on GitHub
            </a>
          </li>
          

          
          <li>
            <a href="https://mapspeople.com/support" title="Contact Support">
              Contact Support
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>MapsIndoors for Android - Part 2 </h1>

			

<h2 id="trying-the-demo-app">Trying the demo App</h2>

<p>You can download the demo app from our github repository: <a href="https://github.com/MapsIndoors/MapsIndoorsAndroid">Demo App</a>
Then run it and don&rsquo;t forget to do a Gradle sync before and download all the required dependencies.</p>

<h2 id="using-routing">Using Routing</h2>

<p>Routing is requested with at least an origin, a destination and a transit mode – transit mode corresponds directly to Google Maps transit modes: Walking, bicycling, driving and transit (public transportation).</p>

<pre><code class="language-java">    RoutingProvider routingProvider = new MPRoutingProvider();
    routingProvider.setOnRouteResultListener(new OnRouteResultListener()
    {
        @Override
        public void onRouteResult(final Route newRoute)
        {
            // Getting route object result
        }

        @Override
        public void onRoutingInfoResult(Object info)
        {

        }
    });
    routingProvider.query(myOriginLocation.getPoint(), myDestinationLocation.getPoint());
</code></pre>

<p>When requesting only indoor routes, the travel mode is always WALKING - regardless of what you assign it to.</p>

<h3 id="route-restrictions">Route restrictions</h3>

<p>Add a restriction to the route by setting the avoid argument. A list of possible restrictions can be found in the com.mapspeople.routing.RouteRestriction class. Avoid stairs on the route using the following restriction parameter:</p>

<pre><code class="language-java">routingProvider.addRouteRestriction(RouteRestriction.AVOID_STAIRS);
</code></pre>

<h3 id="public-transit-travel-mode">Public transit travel mode</h3>

<p>Using TRANSIT mode requires either a departure date or an arrival date.</p>

<pre><code class="language-java">routingProvider.setDateTime(Calendar.getInstance(), false);
</code></pre>

<h3 id="rendering-a-route-on-the-map">Rendering a route on the map</h3>

<p>Using the DirectionsRenderer it is possible to easily render the route retrieved from the RoutingProvider. The route is parted in segments called legs, and legs are again parted in steps. The route will be rendered one leg or step at a time. This is an example of rendering the first leg of a route on a google map. Total number of legs is <code>route.getLegs().size()</code>.</p>

<pre><code class="language-java">DirectionsRenderer directionsRenderer = new DirectionsRenderer(ctx, selectionListener); directionsRenderer.setMap(myGoogleMap); directionsRenderer.setRoute(myRoute); directionsRenderer.setRouteLegIndex(0); //
</code></pre>

<h2 id="working-with-mapped-poi-s-locations">Working with mapped POI’s / Locations</h2>

<h3 id="querying-poi-s-locations">Querying POI&rsquo;s / Locations</h3>

<p>This example will show you the possible ways of querying the POI’s on your venue(s). You need to provide your solution id as a mandatory property to the query.</p>

<pre><code class="language-java">MPLocationsProvider locs = new MPLocationsProvider(this); //Provide context

locs.setOnLocationsReadyListener(new OnLocationsReadyListener() {
   @Override
   public void onLocationsReady(List&lt;Location&gt; locations) {

     // Here you can do your work with the locations

   }

   @Override
   public void onLocationDetailsReady(Location location) {
     
     // Here you can do your work with the locations details

   }
});

LocationQuery lc = new LocationQuery();

lc.arg = &quot;YOUR_SOLUTION_ID&quot;;
lc.setQuery(&quot;lo&quot;);

//Sorting will override &quot;near/radius&quot;
lc.orderBy = LocationQuery.OrderBy.NAME;
lc.sortOrder = LocationQuery.SortOrder.DESC;

lc.near = new Point(55.6377969,12.5787581);
lc.radius = 200;
lc.max = 1;

// query multiple (not all data is fetched)
locs.getLocationsUsingQueryAsync(lc, Locale.ENGLISH);
// or single get (all data is fetched)
locs.getLocationDetailsAsync(&quot;YOUR_SOLUTION_ID&quot;, &quot;locationId&quot;);
</code></pre>

<h3 id="show-a-location-on-map">Show a Location on map</h3>

<p>To show a single POI on a map you can use this method:</p>

<pre><code class="language-java">myMapControl.displaySingleLocation(Location location);
</code></pre>

<h2 id="using-custom-providers">Using Custom Providers</h2>

<p>To setup with e.g. locations from your own backend, make an implementation of the LocationsProvider interface, and pass the provider as parameter to the initMap method:</p>

<pre><code class="language-java">MyLocationsProvider myLocationsProvider = new MyLocationsProvider();
mapControl.initMap(&quot;YOUR_SOLUTION_KEY&quot;, &quot;rtx&quot;, myLocationsProvider, null, null, null);
</code></pre>

<h2 id="determining-and-setting-a-user-location">Determining and setting a user location</h2>

<p>MapsIndoors can show the user position, but to do that it needs to know the user&rsquo;s position. This can either be set manually by the app or using a position provider.
To set it manually, simply call the map control directly with a location and floor, for this case we are going to set it as the venue position:</p>

<pre><code class="language-java">//the point on the map and the floor
mMapControl.setCurrentPosition( new Point(57.08585, 9.95751), 0);
</code></pre>

<p>A position provider is normally easier to use for real time positioning. To create a position provider make a class that implements the PositionProvider interface and add it to your MapControl like this:</p>

<h3 id="using-a-positioning-provider">Using a positioning provider</h3>

<p>The GPS provider is part of the demo app: <a href="https://github.com/MapsIndoors/MapsIndoorsAndroid/blob/master/app/src/main/java/com/mapsindoors/positionprovider/GPSPositionProvider.java">GPSPositionProvider</a>.</p>

<pre><code class="language-java">//Add a position provider in able to track the user's position.
gpsProvider = new GPSPositionProvider(this.getApplicationContext());
//Telling map control about our provider
mMapControl.addPositionProvider(gpsProvider);
mMapControl.startPositioning();
</code></pre>


			<aside class="copyright" role="note">
				
				&copy; 2017 MapsIndoors (c)2017 &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://mapsindoors.github.io/android/" title="MapsIndoors for Android - Getting Started">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              MapsIndoors for Android - Getting Started
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://mapsindoors.github.io/android/reference/" title="MapsIndoors for Android Reference Guide">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              MapsIndoors for Android Reference Guide
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/mapsindoors.github.io\/';
      var repo_id  = 'MapsIndoors\/';
    
    </script>

    <script src="https://mapsindoors.github.io/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-63919776-1', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

