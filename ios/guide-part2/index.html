<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>MapsIndoors for iOS - Part 2 - MapsIndoors Developers</title>
    <meta name="generator" content="Hugo 0.26" />

    
    <meta name="description" content="Everything you need to get started with MapsIndoors.">
    
    <link rel="canonical" href="https://mapsindoors.github.io/ios/guide-part2/">
    
    <meta name="author" content="MapsPeople">
    

    <meta property="og:url" content="https://mapsindoors.github.io/ios/guide-part2/">
    <meta property="og:title" content="MapsIndoors Developers">
    <meta property="og:image" content="https://mapsindoors.github.io/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="MapsIndoors Developers">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://mapsindoors.github.io/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://mapsindoors.github.io/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://mapsindoors.github.io/fonts/icon.eot');
        src: url('https://mapsindoors.github.io/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://mapsindoors.github.io/fonts/icon.woff')
               format('woff'),
             url('https://mapsindoors.github.io/fonts/icon.ttf')
               format('truetype'),
             url('https://mapsindoors.github.io/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://mapsindoors.github.io/stylesheets/application.css">
    <link rel="stylesheet" href="https://mapsindoors.github.io/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://mapsindoors.github.io/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://mapsindoors.github.io/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,700|Roboto&#43;Mono">
    <style>
      body, input {
        font-family: 'Roboto', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <link rel="stylesheet" href="https://mapsindoors.github.io/style.css">
    
    <script src="https://mapsindoors.github.io/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-teal palette-accent-orange">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
    
  <div class="bar default">
      
      
      <div class="button button-back" role="button" aria-label="Back">
        <a href="../" title="Back" class="toggle-button icon icon-back"></a>
      </div>
      
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        MapsIndoors for iOS - Part 2
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/MapsIndoors" title="@MapsIndoors on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">

  
  
    
    
    
  
    
    
    
    <a href="https://mapsindoors.github.io/ios" class="project">
      <div class="banner">
        <div class="logo">
          <img src="https://mapsindoors.github.io//logos/apple-logo.svg" style="padding:10px">
        </div>
        <div class="name">
          <strong>iOS SDK <span class="version">1.11.1</span></strong>
          
        </div>
      </div>
    </a>
    
  
    
    
    
  
    
    
    
  
  <hr />
  <div class="scrollable">
    <div class="wrapper">
      <div class="toc">
          
          
          
          
          
                  
          <ul>
            
            


<li>
    <span class="section">iOS SDK</span>
    <ul>
      
        
        



<a  title="Getting Started" href="https://mapsindoors.github.io/ios">
	
	Getting Started
</a>



      
        
        



<a class="current" title="Next Steps" href="https://mapsindoors.github.io/ios/guide-part2">
	
	Next Steps
</a>


<ul id="scrollspy">
</ul>


      
        
        



<a  title="Reference Docs" href="https://app.mapsindoors.com/mapsindoors/reference/ios/index.html">
	
	Reference Docs
</a>



      
    </ul>
</li>
          </ul>
          
          
          
          
          
          
          
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/MapsIndoors" target="_blank" title="@MapsIndoors on GitHub">
              @MapsIndoors on GitHub
            </a>
          </li>
          

          
          <li>
            <a href="https://mapspeople.com/support" title="Contact Support">
              Contact Support
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>MapsIndoors for iOS - Part 2 </h1>

			

<h2 id="trying-the-demo-app">Trying the demo App</h2>

<p>Open your Terminal and run</p>

<pre><code class="language-swift">pod try MapsIndoors
</code></pre>

<p>This will install and fire up the full-featured SDK Demo Project. Remember to add your own key Google Maps iOS API key in AppDelegate:</p>

<pre><code class="language-swift">GMSServices.provideAPIKey(&quot;YOUR_GOOGLE_KEY&quot;)
</code></pre>

<h2 id="using-routing">Using Routing</h2>

<p>Routing is requested with at least an origin, a destination and a transit mode – transit mode corresponds directly to Google Maps transit modes: Walking, bicycling, driving and transit (public transportation).
The <code>MPDirectionsService</code> class will handle routing and its delegate will receive the resulting <code>MPRoute</code> object. First set up the service:</p>

<pre><code class="language-swift">// the origin of the route that we wont to draw
let origin = MPLocation.init(point: MPPoint.init(lat: 57.08585, lon: 9.95751), andName: &quot;My location&quot;)
// the destination of the route that we wont to draw
let destination = MPLocation.init(point: MPPoint.init(lat: 57.0853743, lon: 9.957698), andName: &quot;Destination&quot;)
// Instantiate the direction service
let directionsService = MPDirectionsService.init(mapsIndoorsSolutionId: clientId, googleApiKey: &quot;YOUR_SOLUTION_ID&quot;)!
directionsService.delegate = self as MPRoutingProviderDelegate ;
directionsService.routing(from: origin, to: destination, by: &quot;WALKING&quot;)

</code></pre>

<p>Then make sure the delegate object, typically one of <code>UIViewController</code>, conforms to <code>MPRoutingProviderDelegate</code>:</p>

<pre><code class="language-swift">ViewController: UIViewController, MPRoutingProviderDelegate
</code></pre>

<p>Hence, by implementing the following method:</p>

<pre><code class="language-swift">
func onRouteResultReady(_ route: MPRoute!) {
      // show the route on the mapView already instantiated with the floor
     route.add(toMap: mapView, highlightFloor: 0)


 }

</code></pre>

<h2 id="querying-poi-s-locations">Querying POI&rsquo;s / Locations</h2>

<p>This example will show you the possible ways of querying the POI’s on your venue(s). You need to provide your solution id as a mandatory property to the query.</p>

<pre><code class="language-swift">  var locationsProvider = MPLocationsProvider()
  locationsProvider?.delegate = self
  var q = MPLocationQuery()
  q.solutionId = &quot;YOUR_SOLUTION_ID&quot; // MapsIndoors solution ID / client ID
  q.query = &quot;lo&quot; //Searches in room ID, name and aliases
  q.max = 10
  q.orderBy = &quot;name&quot; // Possible values are
                       // name, relevance, roomId, floor, building, venue
  q.sortOrder = &quot;desc&quot; // Sorting will override &quot;near/radius&quot;
  q.near = MPPoint(lat: 55.6377969, lon: 12.5787581)
  q.radius = 60 //get nearest locations within 60 metres
  q.max = 1 //get the nearest (a list of one location). Note: To be sure to get at least 1 result, don't set radius
  locationsProvider?.getLocationsUsingQueryAsync(q, language: &quot;en&quot;)
  // or single query
  locationsProvider?.getLocationDetailsAsync(&quot;YOUR_SOLUTION_ID&quot;, withId: &quot;locationID&quot;, language: &quot;en&quot;)
</code></pre>

<p>To show a single POI on a map you can use this method:</p>

<pre><code class="language-swift">  mapControl.selectedLocation = (MPLocation) location
</code></pre>

<p>Implement <code>MPLocationsProviderDelegate</code> and its <code>onLocationsReady</code> method in order to receive the locations result:</p>

<pre><code class="language-swift">  func onLocationsReady( locationData: MPLocationDataset!){

    }
</code></pre>

<h2 id="using-custom-providers">Using Custom Providers</h2>

<p>It is possible to setup MapsIndoors with locations, venues or routing from your own backend. E.g. to use your own locations backend, let your custom provider conform to the MPLocationsProvider protocol (or make a subclass of the interface of same name):</p>

<pre><code class="language-swift">
 class MyCustomLocationsProvider : MPLocationsProvider {

     public override func getLocationsAsync(_ solutionId: String!, language: String!){

     }

     public override func getLocationDetailsAsync(_ solutionId: String!, withId locationId: String!, language: String!){


     }

     public override func getLocationsUsingQueryAsync(_ locationQuery: MPLocationQuery!, language: String!) {


     }

 }

</code></pre>

<p>In cunjunction with your setup code, make <code>MPMapControl</code> use your provider.</p>

<pre><code class="language-swift"> let myProvider = MyCustomLocationsProvider()
 // Place the map above the demo-building
 let camera = GMSCameraPosition.camera(withLatitude: 57.08585, longitude: 9.95751, zoom: 17)
 // Initialise the Google map
 mapView = GMSMapView.map(withFrame: CGRect.zero, camera: camera)
 view = mapView
 let myMapControl = MPMapControl.init(map: mapView)!
 // Use your solution id, site id and the location provider that you instantiated
  myMapControl.setupMap(with: &quot;YOUR_SOLUTION_ID&quot;, site: &quot;YOUR_SITE_ID&quot;, locations: myProvider, venues: nil, routing: nil)
</code></pre>

<p>## Route restrictions
 Add a restriction to the route by setting the avoid argument. Avoid stairs on the route using the following restriction parameter:</p>

<pre><code class="language-swift"> // restrictions table
 let restrictions = [&quot;stairs&quot;]
 directionsService.routing(from: origin, to: destination, by: &quot;WALKING&quot;, avoid: restrictions, depart: nil, arrive: nil)

</code></pre>

<h2 id="using-custom-providers-1">Using Custom Providers</h2>

<p>It is possible to setup MapsIndoors with locations, venues or routing from your own backend. E.g. to use your own locations backend, let your custom provider conform to the MPLocationsProvider protocol (or make a subclass of the interface of same name):</p>

<pre><code class="language-swift">
 class MyCustomLocationsProvider : MPLocationsProvider {

     public override func getLocationsAsync(_ solutionId: String!, language: String!){

     }

     public override func getLocationDetailsAsync(_ solutionId: String!, withId locationId: String!, language: String!){


     }

     public override func getLocationsUsingQueryAsync(_ locationQuery: MPLocationQuery!, language: String!) {


     }

 }

</code></pre>

<p>In cunjunction with your setup code, make <code>MPMapControl</code> use your provider.</p>

<pre><code class="language-swift"> let myProvider = MyCustomLocationsProvider()
 // Place the map above the demo-building
 let camera = GMSCameraPosition.camera(withLatitude: 57.08585, longitude: 9.95751, zoom: 17)
 // Initialise the Google map
 mapView = GMSMapView.map(withFrame: CGRect.zero, camera: camera)
 view = mapView
 let myMapControl = MPMapControl.init(map: mapView)!
 // Use your solution id, site id and the location provider that you instantiated
  myMapControl.setupMap(with: &quot;YOUR_SOLUTION_ID&quot;, site: &quot;YOUR_SITE_ID&quot;, locations: myProvider, venues: nil, routing: nil)
</code></pre>

<p>## Route restrictions
 Add a restriction to the route by setting the avoid argument. Avoid stairs on the route using the following restriction parameter:</p>

<pre><code class="language-swift"> // restrictions table
 let restrictions = [&quot;stairs&quot;]
 directionsService.routing(from: origin, to: destination, by: &quot;WALKING&quot;, avoid: restrictions, depart: nil, arrive: nil)

</code></pre>

<h2 id="route-rendering">Route rendering</h2>

<p>Once a route result is received, you might want to render the route on a map. The <code>MPDirectionsRenderer</code> will handle this for you. This example will setup a renderer and do some initial but optional settings.</p>

<pre><code class="language-swift">
 var directionRenderer = MPDirectionsRenderer()
 let blueColor = UIColor.blue
 directionRenderer.delegate = self
 directionRenderer.map = mapView
 directionRenderer.fitBounds = false
 directionRenderer.solidColor = blueColor
 directionRenderer.backgroundColor = blueColor.withAlphaComponent(0.5)
</code></pre>

<p>So in your onRouteResultReady delegate method, set the route property to trigger the renderer:</p>

<pre><code class="language-swift"> func onRouteResultReady(_ route: MPRoute!) {
   directionsRenderer.route = route;
  }
</code></pre>

<p>Clear the rendering by setting either map or route to nil:</p>

<pre><code class="language-swift"> directionsRenderer.route = nil; // or
 directionsRenderer.map = nil;
</code></pre>

<p>The renderer will split the route in logical parts, called route legs, based on information on context such as indoor/outdoor, access levels etc., but also floor level and transportation type. By default, the first route leg will be shown. Here are examples of rendering other parts of the route.</p>

<pre><code class="language-swift"> directionsRenderer.routeLegIndex = 1 // Render second route leg, if exists
 directionsRenderer.routeLegIndex += 1 // Render next route leg, if exists
 directionsRenderer.routeLegIndex -= 1 // Render previous route leg, if exists
</code></pre>

<p>Given an instance of <code>MPRoute</code>, you can get the number of legs by reading the length of its legs property:</p>

<pre><code class="language-swift"> int numberOfLegs = route.legs.count;
</code></pre>

<p>The rendering can be animated using the animate method just after invoking a rendering.</p>

<pre><code class="language-swift"> directionsRenderer.routeLegIndex = 1;
 directionsRenderer.animate(4) // Animate drawing of route line with 4 seconds duration
</code></pre>

<p>If the rendering of a route leg happens on a new floor level, you might want to get notified, so you can update the current visible floor plan (<code>mapControl.currentFloor</code>). For this purpose you can implement the <code>MPDirectionsRendererDelegate</code> method:</p>

<pre><code class="language-swift"> func floorDidChange(floor: NSNumber!) {
   mapControl.currentFloor = floor
 }
</code></pre>

<p>The route renderer will render a route line and two buttons. In fact they become markers on the <code>GMSMapWiew</code>, but for your convenience we treat them as buttons. In this way you can add target selectors for them:</p>

<pre><code class="language-swift"> directionRenderer.nextRouteLegButton.addTarget(self, action: #selector(showNextRouteLeg), for: UIControlEventTouchUpInside)
 directionRenderer.previousRouteLegButton.addTarget(self, action: #selector(showPreviousRouteLeg), for: UIControlEventTouchUpInside)
</code></pre>


			<aside class="copyright" role="note">
				
				&copy; 2017 MapsIndoors (c)2017 &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://mapsindoors.github.io/ios/" title="MapsIndoors for iOS - Getting Started">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              MapsIndoors for iOS - Getting Started
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://mapsindoors.github.io/ios/reference/" title="MapsIndoors for iOS Reference Guide">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              MapsIndoors for iOS Reference Guide
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/mapsindoors.github.io\/';
      var repo_id  = 'MapsIndoors\/';
    
    </script>

    <script src="https://mapsindoors.github.io/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-63919776-1', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

