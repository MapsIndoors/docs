<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
  </head>
  <body>
    
  <nav>
    <h2>Various</h2>
    
    <ul class="sidebar-nav"><li><a href="/indoor-positioning-with-mapsindoors/">Indoor Positioning with MapsIndoors</a></li>
<li class="active"><a href="/location-sources-in-mapsindoors/">Location Sources in MapsIndoors</a></li>
<li><a href="/ip-whitelisting/">Work with MapsIndoors SDK behind a firewall</a></li>
<li><a href="/sdk-features/">SDK Features</a></li></ul>
  </nav>

    <main>
      <p>Location Sources is a new feature introduced in version 3 of MapsIndoors SDK for Android and iOS. Basically we are making it possible to register your own custom location data source, adhering to a very simple interface.</p>
<h2>The Concepts</h2>
<p>The central concepts in this feature are Location Sources and Location Observers, and they are best described in the following illustration:</p>
<p><img src="assets/source_observer.png" alt="Location Data Sources, Observers and their relation"></p>
<h3>Location Source</h3>
<p>Maintains an array of locations and notifies its Location Observers about location and status updates.</p>
<h3>Location Observer</h3>
<p>Can observe a Location Source for status changes and location updates.</p>
<h2>Creating your own Location Source</h2>
<p>See a <a href="/ios/v3/locations/creating-own-location-sources">demo and tutorial of this feature for iOS</a>. Of course there is more to it than just these interfaces, but assuming that working with the actual 3rd party data is an isolated problem, the setup steps is as follows:</p>
<ol>
<li>Implement a <code>LocationSource</code> that pulls data from your own or a 3rd party database, API or backend and convert this data into MapsIndoors <code>Location</code>'s</li>
<li>Pass the Locations as updates to MapsIndoors through the interface methods of the subscribing <code>LocationObserver</code>'s in your <code>LocationSource</code> implementation.</li>
</ol>
<p>This feature is present in the MapsIndoors SDK for iOS version 3.0.0-alpha. To install this version, just follow the <a href="/ios/v2">latest version 2.1.6 install guide</a>. Replace the pod version to <code>3.0.0-alpha18</code> and run <code>pod install</code>.</p>
<p>Create an implementation of the <code>MPLocationSource</code> interface, implementing all the required methods. When you call <code>MPLocationObserver.onLocationsUpdate()</code> and provide results in <code>MPLocationSource.getLocations()</code> you need to create instances of <code>MPLocation</code>'s. This is done using a builder called <code>MPLocationUpdate</code>. See an example here:</p>
<pre><code class="language-swift">let locationUpdate = MPLocationUpdate.init(id: 134, from: self)                         //Set unique id
locationUpdate.setType(&quot;ViewPoints&quot;)                                                    //Set type
locationUpdate.addPropertyValue(&quot;Empire State Building&quot;, forKey: MPLocationFieldName)   //Set name
locationUpdate.setFloor(86)                                                             //Set floor index
locationUpdate.setPosition(CLLocationCoordinate2DMake(40.7484445, -73.9878584))         //Set position
let location = locationUpdate.location()                                                //Generate location
</code></pre>
<p>While the location ID needs to be unique within your own Location Source, the ID does not need to be unique across all Location Sources.</p>
<p>When you have implemented all methods of your Location Source, you must register the source using the static method <code>MapsIndoors.register()</code>. The following example adds the MapsIndoors default location source as well:</p>
<pre><code class="language-swift">MapsIndoors.register([
            MPMapsIndoorsLocationSource.init(),
            MyLocationsDataSource.init()
        ])
</code></pre>
<h2>IOS Demo and Tutorial for Location Sources</h2>
<p>A full demo example and tutorial is available <a href="/ios/v3/locations/creating-own-location-sources">here</a>.</p>

    </main>
  </body>
</html>
