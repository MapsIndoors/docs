<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="/assets/style.css">
    <title>Document</title>
  </head>
  <body>
    <section class="container">
      
  <nav>
    <h2>Android v3</h2>
    
    <ul class="sidebar-nav"><li class="bold"><a href="/android/v3/guides/">Guides</a><ul><li><a href="/android/v3/tutorials/locationdatasourcespeoplelocationdatasource/">Creating your own Location Data Source - Part 1</a></li>
<li><a href="/android/v3/tutorials/locationdatasourcesbatterieslocationdatasource/">Creating your own Location Data Source - Part 2</a></li>
<li><a href="/android/v3/tutorials/locationdatasourceslocationdatasourcesfragment/">Creating your own Location Data Source - Part 3</a></li>
<li><a href="/android/v3/tutorials/locationclusteringlocationclusteringfragment/">Work with location grouping / clustering</a></li>
<li><a href="/android/v3/tutorials/locationdetailsdemolocationdetailsfragment/">Show Location Details</a></li>
<li><a href="/android/v3/tutorials/searchmapdemosearchfragment/">Create a Search Experience with MapsIndoors - Part 1</a></li>
<li><a href="/android/v3/tutorials/searchmapdemosearchmapfragment/">Create a Search Experience with MapsIndoors - Part 2</a></li>
<li><a href="/android/v3/tutorials/showuserlocationdemopositionprovider/">Show the Blue Dot with MapsIndoors - Part 1</a></li>
<li class="active"><a href="/android/v3/tutorials/showuserlocationshowuserlocationfragment/">Show the Blue Dot with MapsIndoors - Part 2</a></li></ul></li>
<li><a href="/android/v3/changelog/">Changelog</a></li></ul>
  </nav>

      <main>
        <p>This is part 2 of the tutorial of managing a blue dot on the map. <a href="../showuserlocationdemopositionprovider">In Part 1 we created the position provider</a>. Now we will create a Fragment displaying a map that shows the users (mock) location.</p>
<p>Create the class <code>ShowUserLocationFragment</code> that inherits from <code>Fragment</code>:</p>
<pre><code class="language-java">public class ShowUserLocationFragment extends Fragment {
</code></pre>
<p>Add a <code>GoogleMap</code> and a <code>MapControl</code> to the class:</p>
<pre><code class="language-java">GoogleMap mGoogleMap;
MapControl mMapControl;
</code></pre>
<p>Add a map fragment:</p>
<pre><code class="language-java">SupportMapFragment mMapFragment;
</code></pre>
<p>The Venue's coordinates:</p>
<pre><code class="language-java">static final LatLng VENUE_LAT_LNG = new LatLng( 57.05813067, 9.95058065 );
</code></pre>
<p>In the <code>onDestroyView</code> method, we need to free the MapsIndoors PositionProvider:</p>
<pre><code class="language-java">MapsIndoors.setPositionProvider( null );
</code></pre>
<p>Set the API key to the MI solution:</p>
<pre><code class="language-java">if( !MapsIndoors.getAPIKey().equalsIgnoreCase( getString( R.string.mi_api_key ) ) )
{
    MapsIndoors.setAPIKey( getString( R.string.mi_api_key ) );
}
</code></pre>
<p>Instantiate the mapControl object:</p>
<pre><code class="language-java">mMapControl = new MapControl( context );
mMapControl.setGoogleMap( mGoogleMap, mMapFragment.getView() );
</code></pre>
<p>Create an instance of the 'DemoPositionProvider' that we defined previously:</p>
<pre><code class="language-java">DemoPositionProvider demoPositionProvider = new DemoPositionProvider();
</code></pre>
<p>Assign the <code>DemoPositionProvider</code> instance to the <code>MapsIndoors.positionProvider</code> by calling the 'MapsIndoors.setPositionProvider':</p>
<pre><code class="language-java">MapsIndoors.setPositionProvider( demoPositionProvider );
</code></pre>
<p>Tell the mapControl to show the users location:</p>
<pre><code class="language-java">mMapControl.showUserPosition( true );
</code></pre>
<p>Init the mapControl object:</p>
<pre><code class="language-java">mMapControl.init( miError -&gt; {
    if( miError == null )
    {
        final Activity _context = getActivity();
        if( _context != null )
        {
            mMapControl.selectFloor( 1 );
            mGoogleMap.animateCamera( CameraUpdateFactory.newLatLngZoom( VENUE_LAT_LNG, 20f ) );
</code></pre>
<p>Start positioning:</p>
<pre><code class="language-java">demoPositionProvider.startPositioning(null);
</code></pre>
<p><a href="https://github.com/MapsIndoors/MapsIndoorsAndroid-Demo-Samples/blob/master/app/src/main/java/com/mapsindoors/showuserLocation/ShowUserLocationFragment.java">See the sample in ShowUserLocationFragment.java</a></p>

      </main>
    </section>
  </body>
</html>
