<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
  </head>
  <body>
    
  <nav>
    <h2>Android v2</h2>
    
    <ul class="sidebar-nav"><li class="bold"><a href="/android/v2/guides/">Guides</a><ul><li><a href="/android/v2/tutorials/locationdetailsdemolocationdetailsfragment/">Show Location Details</a></li>
<li><a href="/android/v2/tutorials/searchmapdemosearchfragment/">Create a Search Experience with MapsIndoors - Part 1</a></li>
<li><a href="/android/v2/tutorials/searchmapdemosearchmapfragment/">Create a Search Experience with MapsIndoors - Part 2</a></li>
<li><a href="/android/v2/tutorials/showuserlocationdemopositionprovider/">Show the Blue Dot with MapsIndoors - Part 1</a></li>
<li><a href="/android/v2/tutorials/showuserlocationshowuserlocationfragment/">Show the Blue Dot with MapsIndoors - Part 2</a></li></ul></li>
<li><a href="/android/v2/changelog/">Changelog</a></li></ul>
  </nav>


    <main>
      <blockquote>
<p>A <a href="https://www.markdownguide.org/android/v3">newer version</a> of the MapsIndoors SDK for Android is available. The legacy version will not receive new features and will only get critical bugfix and security updates.
{: .mi-warning}</p>
</blockquote>
<p>This guide explains how to start using a MapsIndoors map in your Android application using the MapsIndoors Android SDK v2.</p>
<p>To benefit from the guides, you will need basic knowledge about:</p>
<ul>
<li>Android Development</li>
<li>Google Maps Android API</li>
</ul>
<p>You can get started in two ways, either by reviewing and modifying the <a href="#basic-example">basic example</a> or do the <a href="#setup-mapsindoors">clean setup</a>.</p>
<h2>Basic Example</h2>
<p>You will find in the <a href="https://github.com/MapsIndoors/MapsIndoorsAndroid-Demo-Samples">link</a> a repo that contains the minimum code to start a MapsIndoors project.</p>
<p>You can also follow the steps below to start your app from scratch or to enhance the Basic Examples, more features will be explained in the <a href="/android/v2/guides">guides</a>.</p>
<h2>Setup MapsIndoors</h2>
<p>Add the MapsIndoors SDK as a dependency to your project. The AAR for the MapsIndoors SDK contains both Java classes, SDK resources and AndroidManifest.xml template which gets merged into your application’s AndroidManifest.xml during build process. Add or merge in the following to your app’s build gradle file (usually called build.gradle).</p>
<p>Make sure that the minimum Android SDK version is 21 or above:</p>
<pre><code class="language-groovy">android {
    defaultConfig {
        minSdkVersion 21
    }
    ...
}
</code></pre>
<p>MapsIndoors rely on Java 8 features, so you must add the following compile options, also in <em>android</em> section of your <em>build.gradle</em> file:</p>
<pre><code class="language-groovy">android {
    ...
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }
}
</code></pre>
<p>Add the following dependencies and the MapsIndoors maven repository:</p>
<pre><code class="language-groovy">dependencies {
    ...
    implementation 'com.android.support:support-v4:27.1.0'
    implementation 'com.google.android.gms:play-services-maps:11.8.0'
    implementation 'com.google.code.gson:gson:2.8.2'
    implementation 'com.mapspeople.mapsindoors:mapsindoorssdk:{{%product-version%}}@aar'
}
repositories{
    maven {
        url 'http://maven.mapsindoors.com/'
    }
}
</code></pre>
<p>Put those lines in your proguard-rules files :</p>
<pre><code class="language-groovy">-keep interface com.mapsindoors.mapssdk.** { *; }
-keep class com.mapsindoors.mapssdk.errors.** { *; }
-keepclassmembers class com.mapsindoors.mapssdk.models.** { &lt;fields&gt;; }
-keep class com.mapsindoors.mapssdk.dbglog
</code></pre>
<p>Sync your project with gradle files.</p>
<h2>Setup Google Maps</h2>
<p>Learn how to setup Google Maps on Android in this <a href="https://developers.google.com/maps/documentation/android-api/start">Getting Started Guide</a>.</p>
<h2>Setup a Google Map with MapsIndoors</h2>
<p>Place the following inititalisation code in the <code>onCreate</code> method in the activity that should display the Google map:</p>
<pre><code class="language-java">MapsIndoors.initialize(
  getApplicationContext(),
  &quot;YOUR_MAPSINDOORS_API_KEY&quot;,
  &quot;YOUR_GOOGLE_MAPS_API_KEY&quot;
);
</code></pre>
<p>In your <code>onMapReady</code> callback function, use the <code>MapControl</code> class to set up a Google map with MapsIndoors venues, buildings &amp; locations:</p>
<pre><code class="language-java">// Create a new MapControl instance
myMapControl = new MapControl( getApplicationContext(), mapFragment, mGoogleMap );

// Initialize MapControl to get the locations on the map, etc.
myMapControl.init( errorCode -&gt; {
  if( errorCode == null ) {
    runOnUiThread( () -&gt; {
      // Animate the camera to show the venue
      mGoogleMap.animateCamera( CameraUpdateFactory.newLatLngZoom( new LatLng( 57.05813067, 9.95058065 ), 19f ) );
    });
  }
});
</code></pre>
<p>Head to the <a href="/android/v2/guides">guides</a> to learn about event handling, searching, getting directions, display settings and more.</p>
<h2>Download and Bundle Offline Content</h2>
<p>If needed, it is possible to bundle MapsIndoors content to make your app work better in offline or poor network conditions. (Please note that while MapsIndoors content can be used offline, Google Maps does not provide offline features. Outdoor wayfinding, Google Places searches will be unavailable and the surrounding map may be unavailable unless it has been cached.)</p>
<p>In your <em>/res/values</em> folder, create a file named <code>mapsindoors_api.xml</code> with the following content:</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;resources&gt;
 &lt;string name=&quot;mapsindoors_api_key&quot; translatable=&quot;false&quot;&gt;YOUR_MAPSINDOORS_API_KEY&lt;/string&gt;
&lt;/resources&gt;
</code></pre>
<p>Replace:</p>
<ul>
<li><code>YOUR_MAPSINDOORS_API_KEY</code> with your MapsIndoors API key.</li>
</ul>
<p>In your apps build gradle file, add these two lines:</p>
<pre><code class="language-groovy">apply from: 'https://raw.githubusercontent.com/MapsIndoors/MapsIndoorsAndroid/SDK_V2/scripts/gradle/MapsIndoorsOfflineDataSync.gradle'
preBuild.dependsOn fetchData
</code></pre>
<p>Depending on the overall size of your MapsIndoors deployment, this may take some time, so during development you might want to comment out the script dependency.</p>
<h2>Work with MapsIndoors SDK behind a Firewall</h2>
<p>If you need to work with MapsIndoors SDK behind a firewall, you might need to <a href="../../ip-whitelisting">white-list some IP-adresses</a>.</p>

    </main>
  </body>
</html>
