<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="/assets/style.css">
    <title>Document</title>
  </head>
  <body>
    <section class="container">
      
  <nav>
    <h2>Web</h2>
    
    <ul class="sidebar-nav"><li class="bold"><a href="/web/v3/">MapsIndoors Web SDK v3</a><ul><li class="active bold"><a href="/web/v3/guides/">How to use the MapsIndoors Web SDK v3</a><ul><li><a href="/web/v3/guides/simple_map/">How to create a simple map with MapsIndoors</a></li>
<li><a href="/web/v3/guides/search_and_filtering/">Search and filtering</a></li>
<li><a href="/web/v3/guides/using_events/">Event handling</a></li>
<li><a href="/web/v3/guides/google_analytics/">Google Analytics</a></li></ul></li></ul></li>
<li><a href="/web/v3/changelog/">Changelog</a></li></ul>
  </nav>

      <main>
        <h2>Using the Display rules</h2>
<p>Display rules use the following structure:</p>
<pre><code class="language-javascript">{
   from: zoom_level,             // Optional - defaults to 0
   to: zoom_level,               // Optional - defaults to 21
   icon: google.maps.icon|&quot;url&quot;  // Optional - defaults to current location icon url (dynamically set)
   visible: boolean              // Optional - defaults to true
};
</code></pre>
<p>To add your own custom icons for locations (point-of-interest, rooms, etc.), setup display rule(s) and make it known to your MapsIndoors object.</p>
<pre><code class="language-javascript">var googleMap = new google.maps.Map(...);
var mapsIndoors = new mapsindoors.MapsIndoors({map: googleMap});

mapsIndoors.setDisplayRule(&quot;info&quot;, {from:16, icon:&quot;http://myiconhost.com/info.png&quot; });
</code></pre>
<p>Display rules are based on POI/Location types. Every location has one type property <code>location.properties.type</code>. A set of types is defined/used in the MapsIndoors CMS. The current list of types can be listed using the LocationsService:</p>
<pre><code class="language-javascript">mapsindoors.SolutionService.getSolution().then(function(solution) {
    var types = solution.types;
});
</code></pre>
<p>Two of these types could be of name &quot;Parking” and &quot;Office”, which indicates that these types are used for parking lots and offices respectively. In most cases, you might want to display parking icons on zoom-levels above office icons. Based on this intention you could set these rules:</p>
<pre><code class="language-javascript">mapsIndoors.setDisplayRule(&quot;parking&quot;, { from:16 }); // Using default type icon
mapsIndoors.setDisplayRule(&quot;office&quot;, { from:20 });  // Using default type icon
</code></pre>
<h3>Getting a polygon from a location</h3>
<p>Some locations in MapsIndoors can have additional polygon information. These polygons can be used to render a room or area in a special way or make geofences, calculating whether another point or location is contained within the polygon. If a <code>location</code> has polygons, these can be drawn onto the map this way:</p>
<pre><code class="language-javascript">var polygon = new google.maps.Polygon();

function drawPolygon(location) {
    if (location.geometry &amp;&amp; location.geometry.type === &quot;Polygon&quot;) {
        var paths = location.geometry.coordinates.map(function (ring) {
            return ring.map(function (coordinate) {
                return { lat: coordinate[1], lng: coordinate[0] };
            });
        });

        polygon.setOptions({
            map: googleMap,
            paths: paths
        });
    }
}
</code></pre>
<p>As demonstrated above, a polygon's outer ring/path as well as holes are arranged as [longitude, latitude] pairs. As not all locations have polygons, the polygon array may be empty. On the contrary, some locations, like entire building floors, might have more than polygon.</p>
<h2>Map Rendering</h2>
<h3>Setting the floor</h3>
<p>Sets the current visible floor. This will make visible the corresponding floorplans and the icons on top of it. If the floor index provided does not correlate to any building floor, then the &quot;nearest” floor will be activated. E.g. providing <code>setFloor(4)</code> on a three story building (with floor-indexes 0, 1, 2) will make the topmost floorplan visible (with floor-index 2).</p>
<p>Although floors may have names (&quot;G” for 0, &quot;M1” for 1, &quot;M2” for 2 etc.) you need to set the floor using the index-value.</p>
<pre><code class="language-javascript">myMapsIndoors.setFloor(4)
</code></pre>
<h3>Getting the floor</h3>
<p>Returns current floor index number (integer), e.g. 0 for ground floor, -1 for basement.</p>
<pre><code class="language-javascript">myMapsIndoors.getFloor()
</code></pre>
<h2>Using the Directions Renderer</h2>
<p>Constructor. Takes directions render options as required parameter.</p>
<pre><code class="language-javascript">var directionsRenderer = new mapsindoors.DirectionsRenderer(
{
   mapsindoors: mapsIndoors,     // The MapsIndoors instance
}
);
</code></pre>
<h3>Setting the Options of the Directions Renderer</h3>
<p>Customizing style of route polylines is done using the <code>setOptions</code> method.</p>
<pre><code class="language-javascript">var directionsRenderer = new mapsindoors.DirectionsRenderer();

directionsRenderer.setOptions(
{
   strokeColor: string                                 // The stroke color. All CSS3 colors are supported except for extended named colors.
   strokeOpacity: number                               // The stroke opacity between 0.0 and 1.0.
   strokeWeight: number                                // The stroke width in pixels.
   visible: boolean                                    // Whether this polyline is visible on the map. Defaults to true.
   zIndex: number                                      // The rendering index in relation to other polylines
}
);
</code></pre>
<h3>Getting a Route and Rendering it on a Map</h3>
<p>Renders the route result using the applied render options. Used in conjunction with a DirectionsService, this is an example of displaying a route on the map.</p>
<pre><code class="language-javascript">
var directionsService = mapsindoors.DirectionsService;
var renderer = new mapsindoors.DirectionsRenderer({ mapsindoors: mapsIndoors });

directionsService.getRoute(
   {
      origin: {
         lat: 55.687791059149376,
         lng: 12.571580452361996,
         floor: 0
      },
      destination: {
         lat: 55.687476568798,
         lng: 12.568619293609554,
         floor: 0
      },
      mode: &quot;WALKING&quot;
      avoidStairs: true
   }
).then(function (result) {
   renderer.setRoute(result.routes[0]);
});
</code></pre>
<h3>Clearing a Route Rendering</h3>
<p>Clear the current route rendering.</p>
<pre><code class="language-javascript">directionsRenderer.setRoute(null);
</code></pre>
<h2>Using the Directions Service</h2>
<p>Constructor. Instantiates a service that can be used for making route requests.</p>
<pre><code class="language-javascript">getRoute( request:DirectionsRequest )
</code></pre>
<p>Request routing from a point to another. The request object aligns to the <a href="https://developers.google.com/maps/documentation/javascript/3.exp/reference#DirectionsRequest">Google Maps V3 API DirectionsRequest object specification</a>, but with floor properties on origin and destination. Furthermore, avoidStairs boolean can be set to request routes for both disabled users and users without disabilities.</p>
<pre><code class="language-javascript">var directionsService = mapsindoors.DirectionsService

directionsService.getRoute(
{
   origin: {lat:57.5, lng: 12.9, floor: 0},
   destination: {lat:57.5, lng: 12.9, floor: 0},
   // MapsIndoors options
   avoidStairs: true,
   // Google Directions options
   travelMode: google.maps.TravelMode,
   transitOptions: {...},
   avoidFerries: true,
   ...
}
).then(function(routeResult) {
   // Result will contain possible routes or none if routing failed.
});
</code></pre>
<h3>Getting Icons from Location Types</h3>
<p>A set of location types is defined for every MapsIndoors solution. The current list of types can be retrieved like this:</p>
<pre><code class="language-javascript">var solutionService = mapsindoors.SolutionService;

solutionService.getTypes().then(function(types) {
   // returns array of types with format { name:string, displayRule: { icon:'https://icon.url' } }
   console.log(types[0].displayRule.icon);
});
</code></pre>
<h3>Getting the Location Details</h3>
<p>Get the full details object of a single location. Pass the MapsIndoors id string present in any location object at <code>location.id</code>.</p>
<pre><code class="language-javascript">var locations = new mapsindoors.LocationsService();
// Get all locations
locations.getLocations().then(function(data) {
   locations.getLocationDetails(data[0].id).then(function(detailedData) {
      // Returns a full-detail location object
   });
});
</code></pre>
<h2>Map Styles</h2>
<p>A MapsIndoors map may have multiple styles/layouts. This is how a mapStyle object is structured.</p>
<pre><code class="language-javascript">let mapStyle = {
    folder: 'styleFolder',
    displayName: 'styleDisplayName' // Optional when created
}
</code></pre>
<p>When a new instance of MapsIndoors is created, it is created with the Google map as an argument. It is also possible to set the map style in the constructor.</p>
<pre><code class="language-javascript">let mapsIndoors = new mapsindoors.MapsIndoors({
    map: googleMap,
    mapStyle: MapStyle
});
</code></pre>
<p>It is also possible to set or get the map style at a later time, after MapsIndoors has been instantiated.</p>
<pre><code class="language-javascript">google.maps.event.addListener(mapsIndoors, 'ready', function () {
    /* Get all avalible styles. */
    let styles = mapsIndoors.getMapStyles();
    /* Set the first style in the list as the one to be shown on the map. */
    mapsIndoors.setMapStyle(styles[0]);
    /* Get the current map style. */
    let style = mapsIndoors.getMapStyle();
});
</code></pre>

      </main>
    </section>
  </body>
</html>
