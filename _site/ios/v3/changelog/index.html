<p>Changelog for MapsIndoors for iOS. This document structure is based on <a href="http://keepachangelog.com/en/1.0.0/">Keep a Changelog</a> and the project adheres to <a href="http://semver.org/spec/v2.0.0.html">Semantic Versioning</a>.</p>
<!---
## [Unreleased]
### Fixed
### Added
### Fixed
### Changed
### Removed
-->
<blockquote>
<p>Known Issues:</p>
</blockquote>
<ol>
<li>If you are compiling with Xcode 11 with bitcode ON, you should either switch OFF bitcode or update to version 3.6.0 or later. With bitcode ON, previous versions of the SDK could crash. We are in dialog with Apple regarding the bitcode issue.
{: .mi-careful}</li>
</ol>
<h2>[3.7.1] 2019-12-05</h2>
<h3>Added</h3>
<ul>
<li>Added <code>MPMapControl</code> now has new functionality for temporarily changing the <code>MPDisplayRule</code> for individual <code>MPLocations</code>.  See <code>-[MPMapControl setDisplayRule:forLocation:]</code>, <code>-[MPMapControl resetDisplayRuleForLocation:]</code> and similar methods.</li>
</ul>
<h3>Changed</h3>
<ul>
<li>Multiple improvements to the search engine has been implemented.</li>
</ul>
<h2>[3.6.2] 2019-11-18</h2>
<h3>Fixed</h3>
<ul>
<li>Fixed a memory leak happening when switching solution / api-key.</li>
<li>Fixed <code>MPMapControl</code> is now more resilient against <code>GMSMapView.delegate</code> being changed.</li>
<li><a href="https://forums.developer.apple.com/thread/123003">This issue</a> made our SDK crash if built with XCode 10 and below. We have implemented a workaround in this version.</li>
<li>Fixed Restored previous behaviour where the map settles on a building and showing the floor selector initially.</li>
<li>Fixed Improved switching between different Solutions / API keys.</li>
</ul>
<h2>[3.6.1] 2019-11-05</h2>
<h3>Fixed</h3>
<ul>
<li>Fixed synchronisation issue, that sometimes caused map graphics to disappear, if the app was shut down in the middle of a synchronisation.</li>
<li>Fixed directions rendering issue causing the map camera to display random parts of the Google map instead of the step or leg that was intended to be rendered.</li>
<li>Fixed some inconsistencies in how non-quadratic icons was anchored on the map.</li>
</ul>
<h3>Changed</h3>
<ul>
<li>Locations can now be configured as searchable (from the backend), which in effect makes them eligible for map display but not retrievable from a search query through <code>MPLocationService</code>.</li>
</ul>
<h2>[3.6.0] 2019-10-10</h2>
<h3>Fixed</h3>
<ul>
<li><code>MPDirectionsQuery.init(originPoint:MPPoint, destPoint:MPPoint)</code> could produce origins and destinations on level 0, resulting in incorrect route results.</li>
</ul>
<h3>Changed</h3>
<ul>
<li>Compiled with Xcode 11 for iOS 13</li>
<li>Internal refactoring to improve memory and threading error resilience.</li>
</ul>
<h2>[3.5.0] 2019-09-25</h2>
<h3>Added</h3>
<ul>
<li>Added <code>depth</code> property to <code>MPFilter</code>, used with the <code>parents</code> property, making it possible to e.g. get all buildings and floors within a venue (depth 2) or get only floors within a building (depth 1).</li>
<li>Added the ability to control the visibility of map icons and map labels independently, through <code>MPLocationDisplayRule.showIcon</code> and  <code>MPLocationDisplayRule.showLabel</code>.</li>
<li>Added property <code>locationBaseType</code> on <code>MPLocation</code>, making it possible to dstinguish buildings from venues, floors from rooms, areas from POIs etc.</li>
</ul>
<h3>Fixed</h3>
<ul>
<li>Fixed issue with info window disappearing after location selection when search result is currently rendered.</li>
<li>Fixed some internal concurrency issues.</li>
</ul>
<h2>[3.3.1] 2019-09-15</h2>
<h3>Changed</h3>
<ul>
<li>InfoWindows presented on the map is now made fully visible if needed - this changes the presented map area.</li>
</ul>
<h3>Fixed</h3>
<ul>
<li>Fixed location data was only synced once per session, regardless of explicit calls to <code>MapsIndoors.synchronizeContent()</code>.</li>
</ul>
<h2>[3.3.0] 2019-08-30</h2>
<h3>Added</h3>
<ul>
<li>Support for custom fields on venues, buildings and categories (writable from the MapsIndoors Data API).</li>
</ul>
<h2>[3.2.0] 2019-08-20</h2>
<h3>Changed</h3>
<ul>
<li>Updated Google Maps SDK from 3.1.0 to 3.3.0 (see <a href="https://developers.google.com/maps/documentation/ios-sdk/releases">https://developers.google.com/maps/documentation/ios-sdk/releases</a> for details).</li>
<li>Default Google Maps styling is now applied to the map, so that we hide Google Maps icons that usually compete with, confuse or disturb the appearance of MapsIndoors location icons.</li>
</ul>
<h3>Added</h3>
<ul>
<li>Support for building default floors.</li>
<li>Support for profile-based routing.</li>
<li>Support for travelmode specific venue entrypoints, so f.ex. driving routes can go via parking lots (require data configuration).</li>
</ul>
<h3>Fixed</h3>
<ul>
<li>Fixed an issue with loading solution-data from the MapsIndoors backend.</li>
<li>Fixed an issue with searching for location aliases.</li>
<li>Fixed a memory issue that can happen when multiple map instances are created in one session.</li>
<li>Fixed a rare race condition during initialization.</li>
</ul>
<h2>[3.1.2] 2019-06-27</h2>
<h3>Fixed</h3>
<ul>
<li>Fixed memory issue related to adding observers to <code>MPMapsIndoorsLocationSource</code>  in relation to entering and leaving a MapsIndoors map multiple times in the same session.</li>
<li>Fixed occasional orphaned/ghost polyline from the <code>MPDirectionsRenderer</code>.</li>
<li>Fixed wrong floor tiles showing in route step in some cases.</li>
<li>Fixed an issue with route rendering.</li>
<li>Fixed info window not appearing for selectedLocation after several API key switches.</li>
</ul>
<h2>[3.1.1] 2019-06-21</h2>
<h3>Fixed</h3>
<ul>
<li>Fixed <code>MPMapControl.go(to:MPLocation)</code> so that the map now properly fits locations with polygons.</li>
<li>Fixed dataset switching sometimes not working due to re-initialisation not properly executed behind the scenes.</li>
<li>Fixed memory issues related to entering and leaving a MapsIndoors map multiple times in the same session.</li>
<li>Adding custom <code>MPLocationDisplayRule</code> not affecting size and rank changes due to a race condition.</li>
<li>Fixed a problem with transitioning from a Google route to a MapsIndoors route.</li>
</ul>
<h2>[3.1.0] 2019-06-04</h2>
<h3>Added</h3>
<ul>
<li>Added a <code>MPGeometryHelper</code> class.</li>
<li>Added a way to get polygons for locations using <code>MPGeometryHelper.polygonsForLocation(location:MPLocation)</code>.</li>
<li>Updated Google Maps dependency to version 3.1.0.</li>
<li>Optimizing outdoor/indoor directions. Filters entry points by new travel mode flag in SDK before doing calculations.</li>
<li>Now possible to set map style (layout) using <code>MPMapControl.mapStyle = MPMapStyle(string:&quot;my-style&quot;)</code>. Only applies for data sets that has multiple defined styles.</li>
</ul>
<h3>Fixed</h3>
<ul>
<li>Fixed map markers being anchored at the bottom of a square icon, not the center.</li>
<li>Fixed a race condition in the initial data fetch causing locations search results to be initially empty.</li>
<li>Fixed error causing locations to show across all Floors when displaying as search result.</li>
<li>Fixed tapping on Information Window does not center view based on selected location.</li>
</ul>
<h2>[3.0.4] 2019-04-29</h2>
<h3>Fixed</h3>
<ul>
<li>Improved search functionality.</li>
<li>Fixed an issue with directions only returning routes on ground floor.</li>
<li>Fixed issue with the directions service not resorting to offline even in case of cached route-networks.</li>
<li>Fixed an issue where would return more than expected results when perfect match(es) was found.</li>
</ul>
<h2>[3.0.3] 2019-04-11</h2>
<h3>Fixed</h3>
<ul>
<li>Fixed an issue changing MapsIndoors.positionProvider during the runtime of the app.</li>
</ul>
<h2>[3.0.2] 2019-04-08</h2>
<h3>Fixed</h3>
<ul>
<li>Fixed an issue where MPMapControl would not update it's current location.</li>
</ul>
<h2>[3.0.1] 2019-04-03</h2>
<h3>Added</h3>
<ul>
<li>MPMapControlDelegate now has a new method for notifying about which building is focused on the map  <code>- [MPMapControlDelegate focusedBuildingDidChange:(nullable MPLocation*)building]</code></li>
<li>MPMapControlDelegate now has a new method for notifying position updates  <code>- [MPMapControlDelegate onPositionUpdate:(nonnull MPPositionResult*)positionResult]</code></li>
</ul>
<h3>Changed</h3>
<ul>
<li>MPMapControl.currentPosition has been deprecated; use MapsIndoors.positionProvider.latestPositionResult to know current position.</li>
</ul>
<h3>Fixed</h3>
<ul>
<li>Fixed an issue related to MPLocations using the default displayrule as well as their own icon.</li>
<li>Fixed an issue causing MPLocationUpdate/MPLocation to always set floor index to zero on updates.</li>
</ul>
<h2>[3.0.0] 2019-03-04</h2>
<h3>Added</h3>
<ul>
<li>Support for external location data sources using <code>[MapsIndoors registerLocationSources:sources]</code></li>
<li>New location service <code>MPLocationService</code> to replace <code>MPLocationsProvider</code></li>
<li>Location clustering support using <code>MPMapControl.locationClusteringEnabled</code></li>
<li>Added building and venues to the search experience</li>
</ul>
<h3>Changed</h3>
<ul>
<li>MPLocation properties are now read only</li>
</ul>
<h3>Removed</h3>
<ul>
<li>Removed a number of deprecated methods that was introduced in V1</li>
</ul>
