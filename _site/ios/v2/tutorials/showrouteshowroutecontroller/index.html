<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="/assets/style.css">
    <title>Document</title>
  </head>
  <body>
    <section class="container">
      
  <nav>
    <h2>iOS v2</h2>
    
    <ul class="sidebar-nav"><li><a href="/ios/v2/guides/">Guides</a></li>
<li class="bold"><a href="/ios/v2/tutorials/">Tutorials</a><ul><li><a href="/ios/v2/tutorials/locationdetailslocationdetailscontroller/">Show location details</a></li>
<li><a href="/ios/v2/tutorials/searchmysearchcontroller/">Create a Search Experience with MapsIndoors - Part 1</a></li>
<li><a href="/ios/v2/tutorials/showmylocationmypositionprovider/">Show the Blue Dot with MapsIndoors - Part 1</a></li>
<li><a href="/ios/v2/tutorials/showmylocationshowmylocationcontroller/">Show the Blue Dot with MapsIndoors - Part 2</a></li>
<li><a href="/ios/v2/tutorials/showrouteshowrouteonmapcontroller/">Get Directions and Show the Result on a Map - Part 1</a></li>
<li class="active"><a href="/ios/v2/tutorials/showrouteshowroutecontroller/">Get Directions and Show the Result on a Map - Part 2</a></li></ul></li>
<li><a href="/ios/v2/changelog/">Changelog</a></li></ul>
  </nav>


      <main>
        <blockquote>
<p>A <a href="https://www.markdownguide.org/ios/v3">newer version</a> of the MapsIndoors SDK for iOS is available. The legacy version will not receive new features and will only get critical bugfix and security updates.
{: .mi-warning}</p>
</blockquote>
<p>This is part 2 of the tutorial of requesting directions and showing the route result on a map. In <a href="../showrouteshowrouteonmapcontroller">Part 1</a> we created the controller that can display the map and route, and in this part we will create the controller that requests the route and list the route in a table. A MapsIndoors route is made of one or more legs, each containing one or more steps.</p>
<p>Start by creating a <code>UIViewController</code> implementation</p>
<pre><code class="language-swift">class ShowRouteController: UITableViewController {
</code></pre>
<p>Add a <code>MPRoute</code> property to the class</p>
<pre><code class="language-swift">var route:MPRoute? = nil
</code></pre>
<p>Inside <code>viewDidLoad</code>, setup a directions service, call the directions service and save the route result to your <code>MPRoute</code> property</p>
<pre><code class="language-swift">let directions = MPDirectionsService.init()

let origin = MPPoint.init(lat: 57.057917, lon: 9.950361, zValue:0)
let destination = MPPoint.init(lat: 57.058038, lon: 9.950509, zValue:1)

let directionsQuery = MPDirectionsQuery.init(originPoint: origin!, destination: destination!)

directions.routing(with: directionsQuery) { (route, error) in
    self.route = route
    self.tableView.reloadData()
}
</code></pre>
<p>Override <code>numberOfRowsInSection</code> to return the number of steps in the current leg plus the leg itself</p>
<pre><code class="language-swift">override func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -&gt; Int {
    if let leg:MPRouteLeg = route?.legs?[section] as? MPRouteLeg {
        return leg.steps!.count + 1
    }
    return 0
}
</code></pre>
<p>Override <code>numberOfSections</code> to return the number of legs</p>
<pre><code class="language-swift">override func numberOfSections(in tableView: UITableView) -&gt; Int {
    if let legs = route?.legs?.count {
        return legs
    }
    return 0
}
</code></pre>
<p>Override <code>titleForHeaderInSection</code> to return the leg index</p>
<pre><code class="language-swift">override func tableView(_ tableView: UITableView, titleForHeaderInSection section: Int) -&gt; String? {
    return &quot;Route Leg \(section)&quot;
}
</code></pre>
<p>Override <code>tableView:cellForRowAt</code> to return leg index and step index if applicable</p>
<pre><code class="language-swift">override func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&gt; UITableViewCell {
    let cell = UITableViewCell.init()

    if indexPath.row &gt; 0 {
        cell.textLabel?.text = &quot;Show leg \(indexPath.section), step \(indexPath.row - 1)&quot;
    } else {
        cell.textLabel?.text = &quot;Show leg \(indexPath.section), all steps&quot;
    }
    cell.accessibilityIdentifier = cell.textLabel?.text

    return cell
}
</code></pre>
<p>Override <code>tableView:didSelectRowAt</code> to push a new view controller</p>
<pre><code class="language-swift">override func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
    let vc = ShowRouteOnMapController.init(route!, indexPath.section, indexPath.row - 1)
    navigationController?.pushViewController(vc, animated: true)
}
</code></pre>
<p><a href="https://github.com/MapsIndoors/MapsIndoorsIOS/blob/master/Example/DemoSamples/Show%20Route/ShowRouteController.swift">See the sample in ShowRouteController.swift</a></p>

      </main>
    </section>
  </body>
</html>
